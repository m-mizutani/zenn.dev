---
title: "ç”ŸæˆAIé€£æºåž‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ©ãƒ¼ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ : Warren"
emoji: "ðŸ‡"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["security", "monitoring", "ç”Ÿæˆai", "mcp", "aiã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ"]
published: true
---

å°è¦æ¨¡ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒ¼ãƒ ã«ã¨ã£ã¦ã€å¤§é‡ã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é™ã‚‰ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã§å‡¦ç†ã™ã‚‹ã“ã¨ã¯å¤§ããªèª²é¡Œã§ã™ã€‚çªç„¶ç™ºç”Ÿã—ãŸæ•°ç™¾ä»¶ã®ã‚¢ãƒ©ãƒ¼ãƒˆã®ã†ã¡ã€å¤šãã¯åŒã˜äº‹è±¡ã®é‡è¤‡ã‚„èª¤æ¤œçŸ¥ã§ã™ãŒã€ãã®ä¸­ã«é‡è¦ãªã‚¢ãƒ©ãƒ¼ãƒˆãŒåŸ‹ã‚‚ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ã€‚

å¾“æ¥ã®SOARï¼ˆSecurity Orchestration, Automation and Responseï¼‰ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã‚‹è‡ªå‹•åŒ–ã¯ã€åŽ³å¯†ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®šç¾©ã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã«å¤šå¤§ãªåŠ´åŠ›ã‚’è¦ã—ã¾ã™ã€‚ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆã®å¤‰æ›´ã‚„æ–°ã—ã„è„…å¨ãŒç™ºç”Ÿã™ã‚‹ãŸã³ã«ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ›´æ–°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€å°è¦æ¨¡ãƒãƒ¼ãƒ ã§ã¯ç¾å®Ÿçš„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

ãã“ã§ã€ç”ŸæˆAIã‚’æ´»ç”¨ã—ãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ãƒ„ãƒ¼ãƒ«ã€ŒWarrenã€ã‚’é–‹ç™ºã—ã¾ã—ãŸã€‚Warrenã¯ã€åŽ³å¯†ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã“ã¨ãªãã€è‡ªç„¶è¨€èªžã§ã®æŒ‡ç¤ºã«ã‚ˆã£ã¦è¤‡é›‘ãªåˆ†æžã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚é¡žä¼¼ã‚¢ãƒ©ãƒ¼ãƒˆã®è‡ªå‹•ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã€è„…å¨ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®é€£æºã€Slackã¨Web UIã®ä¸¡ç«‹ãªã©ã€å°è¦æ¨¡ãƒãƒ¼ãƒ ã®å®Ÿå‹™ã«å¿…è¦ãªæ©Ÿèƒ½ã‚’å‚™ãˆã¦ã„ã¾ã™ã€‚

https://github.com/secmon-lab/warren

æœ¬è¨˜äº‹ã§ã¯ã€Warrenã®é–‹ç™ºèƒŒæ™¯ã¨ãªã£ãŸå°è¦æ¨¡ãƒãƒ¼ãƒ ã®å…·ä½“çš„ãªèª²é¡Œã‹ã‚‰ã€WarrenãŒã©ã®ã‚ˆã†ã«ã“ã‚Œã‚‰ã‚’è§£æ±ºã™ã‚‹ã‹ã€ãã—ã¦å®Ÿéš›ã®ä½¿ã„æ–¹ã¾ã§ã‚’è©³ã—ãèª¬æ˜Žã—ã¾ã™ã€‚

# å°è¦æ¨¡ãªãƒãƒ¼ãƒ ã«ãŠã‘ã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã®èª²é¡Œ

å°è¦æ¨¡ãƒãƒ¼ãƒ ã¨ã—ã¦ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã®åŠ¹çŽ‡åŒ–ã‚’ç›®æŒ‡ã—ãŸèƒŒæ™¯ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªèª²é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚

## åå¾©çš„ã ãŒå®šåž‹åŒ–ã—ãã‚Œãªã„ä½œæ¥­ã®å¤šã•

ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã§ã¯ã€è„…å¨æƒ…å ±ã®èª¿æŸ»ã‚„ã‚¢ãƒ©ãƒ¼ãƒˆã®åˆ†æžãªã©ã€ä¼¼ãŸã‚ˆã†ãªä½œæ¥­ã‚’ç¹°ã‚Šè¿”ã™ã“ã¨ãŒå¤šã„ã§ã™ã€‚ã—ã‹ã—ã€ã“ã‚Œã‚‰ã®ä½œæ¥­ã¯ã™ã¹ã¦ã‚’å®Œå…¨ã«å®šåž‹åŒ–ã™ã‚‹ã“ã¨ãŒé›£ã—ã„ã¨ã„ã†ç‰¹å¾´ãŒã‚ã‚Šã¾ã™ã€‚

ä¾‹ãˆã°ã€Œä¸å¯©ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã€ã¨ã„ã†ã‚¢ãƒ©ãƒ¼ãƒˆã®å ´åˆã€åŸºæœ¬çš„ãªèª¿æŸ»ã®æµã‚Œã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

1. IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®æ‰€æœ‰è€…æƒ…å ±ã‚’ç¢ºèª
2. è„…å¨ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ã‚µãƒ¼ãƒ“ã‚¹ã§ãƒ¬ãƒ”ãƒ¥ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯
3. éŽåŽ»ã«åŒã˜IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒã‚ã£ãŸã‹ç¢ºèª
4. ã‚¢ã‚¯ã‚»ã‚¹å…ˆã®ã‚·ã‚¹ãƒ†ãƒ ã®é‡è¦åº¦ã‚’è©•ä¾¡

ã—ã‹ã—å®Ÿéš›ã«ã¯ã€æ¤œçŸ¥ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå†…éƒ¨/å¤–éƒ¨ã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ï¼‰ã«ã‚ˆã£ã¦åŒã˜ã‚ˆã†ãªç¨®é¡žã®ã‚¢ãƒ©ãƒ¼ãƒˆã§ã‚‚ã‚¹ã‚­ãƒ¼ãƒžãŒç•°ãªã‚Šã¾ã™ã€‚ã¾ãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå«ã¾ã‚Œã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ã‚‚æ§˜ã€…ãªæ„å‘³ã‚’æŒã¤IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒ1ã¤ã®ã‚¢ãƒ©ãƒ¼ãƒˆã«ç™»å ´ã—ã¾ã™ã€‚ä¾‹ãˆã°ã€ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼ã®ãƒ­ã‚°ã§ã¯ã€Œã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIPã€ã€Œãƒ—ãƒ­ã‚­ã‚·IPã€ã€ŒæŽ¥ç¶šå…ˆIPã€ã¨ã„ã£ãŸè¤‡æ•°ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå­˜åœ¨ã—ã€ãã‚Œãžã‚Œåˆ†æžã®è¦³ç‚¹ãŒç•°ãªã‚Šã¾ã™ã€‚ã“ã®ã‚ˆã†ãªã‚¹ã‚­ãƒ¼ãƒžã®å¯¾å¿œã¯SOARã®ã‚ˆã†ãªã‚·ã‚¹ãƒ†ãƒ ã«ã¯å¿…è¦ã§ã™ã€‚

ã•ã‚‰ã«ã€èª¿æŸ»ã®éŽç¨‹ã§ã€Œã“ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯éŽåŽ»ã«ã‚‚ä¼¼ãŸã‚ˆã†ãªã‚¢ã‚¯ã‚»ã‚¹ã‚’ã—ã¦ã„ãŸã‹ï¼Ÿã€ã€ŒåŒã˜æ™‚é–“å¸¯ã«ä»–ã®ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚‚ã‚ã£ãŸã‹ï¼Ÿã€ã¨ã„ã£ãŸæ–°ãŸãªç–‘å•ãŒç”Ÿã˜ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã®ã‚ˆã†ãªæ–°ãŸãªç–‘å•ç‚¹ã«ã¤ã„ã¦å†å¸°çš„ã«å¯¾å¿œã•ã›ã‚‹æ–¹æ³•ã‚’æ¤œè¨Žã—ãŸããªã‚Šã¾ã™ã€‚

å¾“æ¥ã®SOARãƒ„ãƒ¼ãƒ«ã§ã¯ã€ã“ã‚Œã‚‰ã™ã¹ã¦ã®å¯èƒ½æ€§ã‚’äº‹å‰ã«ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¨ã—ã¦å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚è¤‡æ•°ã®ã‚¹ã‚­ãƒ¼ãƒžã«å¯¾å¿œã—ã•ã¾ã–ã¾ãªæ¡ä»¶åˆ†å²ãŒè¤‡é›‘ã«çµ„ã¿åˆã‚ã•ã‚‹ã¨ã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è‡ªä½“ãŒéžå¸¸ã«è¤‡é›‘ã«ãªã‚Šã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒå›°é›£ã«ãªã‚Šã¾ã™ã€‚SOARã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒå›°é›£ã§ã‚ã‚‹ã“ã¨ã¯ä»¥å‰ã‹ã‚‰ã‚‚æŒ‡æ‘˜ã•ã‚Œã¦ãã¾ã—ãŸ[^soar-is-dead]ã€‚

## åˆ†æžã«å¿…è¦ãªå‰æçŸ¥è­˜ã®å¤šã•

ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é©åˆ‡ã«åˆ†æžã™ã‚‹ãŸã‚ã«ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«é–¢ã™ã‚‹çŸ¥è­˜ã ã‘ã§ãªãã€çµ„ç¹”å›ºæœ‰ã®ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚

ä¾‹ãˆã°ã€Œã‚µãƒ¼ãƒãƒ¼Aã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼Bã¸ã®å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿è»¢é€ã€ã¨ã„ã†ã‚¢ãƒ©ãƒ¼ãƒˆãŒç™ºç”Ÿã—ãŸå ´åˆã€ã‚¢ãƒŠãƒªã‚¹ãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ãªè†¨å¤§ãªæƒ…å ±ã‚’é ­ã®ä¸­ã§ç®¡ç†ã—ã€çž¬æ™‚ã«åˆ¤æ–­ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

- å„ã‚µãƒ¼ãƒãƒ¼ã®å½¹å‰²ã¨é€šå¸¸ã®é€šä¿¡ãƒ‘ã‚¿ãƒ¼ãƒ³
- ãƒ‡ãƒ¼ã‚¿è»¢é€ãŒç™ºç”Ÿã™ã‚‹å ´åˆã®é »åº¦ã¨é‡
- ç™ºç”Ÿæ™‚é–“å¸¯ã¨æ¥­å‹™æ™‚é–“ã®é–¢ä¿‚
- æœ€è¿‘ã®ã‚·ã‚¹ãƒ†ãƒ å¤‰æ›´ã®æœ‰ç„¡

å°è¦æ¨¡ãƒãƒ¼ãƒ ã§ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒŠãƒªã‚¹ãƒˆã¯æ•°ç™¾ã‹ã‚‰æ•°åƒã®ã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦ã€ã“ã‚Œã‚‰ã®æƒ…å ±ã‚’è¨˜æ†¶ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã€Œã“ã®ã‚µãƒ¼ãƒãƒ¼ã¯æœˆåˆã«å¿…ãšãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è»¢é€ã™ã‚‹ã€ã€Œã‚ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ¯Žæ—¥åˆå‰3æ™‚ã«ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã€ã€Œã“ã®éƒ¨ç½²ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æµ·å¤–å‡ºå¼µãŒå¤šã„ã€ã¨ã„ã£ãŸç„¡æ•°ã®ä¾‹å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã€ã™ã¹ã¦äººé–“ã®è¨˜æ†¶ã«ä¾å­˜ã—ã¦ã„ã‚‹ã®ãŒç¾çŠ¶ã§ã™ã€‚

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã‚‚é™ç•ŒãŒã‚ã‚Šã¾ã™ã€‚ã†ã¾ããƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã•ã‚Œã¦ã„ãŸã¨ã—ã¦ã‚‚ã€å¤§é‡ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ·±å¤œã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œä¸­ã«è©²å½“ç®‡æ‰€ã‚’æŽ¢ã—å‡ºã™ã®ã¯ç¾å®Ÿçš„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚çµå±€ã€çµŒé¨“è±Šå¯Œãªã‚¢ãƒŠãƒªã‚¹ãƒˆã®è¨˜æ†¶ã¨å‹˜ã«ä¾å­˜ã›ã–ã‚‹ã‚’å¾—ãªããªã‚ŠãŒã¡ã§ã™ã€‚

## ã‚¢ãƒ©ãƒ¼ãƒˆæ•´ç†ã®æ‰‹é–“

ã‚ã‚‹æœã€ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã¨å¤œé–“ã«1,000ä»¶ã‚ã¾ã‚Šã®ã‚¢ãƒ©ãƒ¼ãƒˆãŒç™ºç”Ÿã—ã¦ã„ãŸã¨ã—ã¾ã™ï¼š

- ãƒãƒ¼ãƒˆã‚¹ã‚­ãƒ£ãƒ³æ¤œçŸ¥ï¼š900ä»¶ï¼ˆ10å°ã®ã‚µãƒ¼ãƒãƒ¼Ã—80ãƒãƒ¼ãƒˆï¼‰
- ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ï¼š150ä»¶ï¼ˆåŒä¸€IPã‹ã‚‰ã®è¤‡æ•°ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸ã®è©¦è¡Œï¼‰
- ç•°å¸¸ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ï¼š30ä»¶ï¼ˆå®šæœŸãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã«ã‚ˆã‚‹èª¤æ¤œçŸ¥ï¼‰
- ã‚³ãƒ³ãƒ†ãƒŠä¸Šã®ãƒ—ãƒ­ã‚»ã‚¹ç•°å¸¸ï¼š1ä»¶ï¼ˆçœŸã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã€ã‚³ãƒ³ãƒ†ãƒŠã«ä¾µå…¥ã•ã‚ŒãŸå½¢è·¡ï¼‰

å®Ÿéš›ã«ã¯ã€900ä»¶ã®ãƒãƒ¼ãƒˆã‚¹ã‚­ãƒ£ãƒ³ã¯ã€Œ10å°ã¸ã®ã‚¹ã‚­ãƒ£ãƒ³ã€ã¨ã„ã†1ã¤ã®äº‹è±¡ã€150ä»¶ã®ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ã¯ã€Œ1ã¤ã®IPã‹ã‚‰ã®ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã€ã§ã™ã€‚ã—ã‹ã—ã€æœ€ã‚‚é‡è¦ãªã®ã¯ãŸã£ãŸ1ä»¶ã®ã‚³ãƒ³ãƒ†ãƒŠãƒ—ãƒ­ã‚»ã‚¹ç•°å¸¸ã§ã€ã“ã‚Œã¯å®Ÿéš›ã«ã‚³ãƒ³ãƒ†ãƒŠãŒä¾µå®³ã•ã‚ŒãŸã“ã¨ã‚’ç¤ºã™é‡å¤§ãªã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã§ã™ã€‚

å°è¦æ¨¡ãƒãƒ¼ãƒ ã§ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã«å‰²ã‘ã‚‹æ™‚é–“ãŒ1æ—¥2ã€œ3æ™‚é–“ç¨‹åº¦ã®å ´åˆã€å¤§é‡ã®ã‚¢ãƒ©ãƒ¼ãƒˆã«åœ§å€’ã•ã‚Œã¦ã“ã®é‡è¦ãª1ä»¶ã‚’è¦‹é€ƒã™ãƒªã‚¹ã‚¯ãŒéžå¸¸ã«é«˜ããªã‚Šã¾ã™ã€‚çµæžœã¨ã—ã¦ã€ã‚¢ãƒ©ãƒ¼ãƒˆç–²ã‚Œã€å¯¾å¿œã®é…å»¶ã€ãã—ã¦æœ€æ‚ªã®å ´åˆã¯çœŸã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã®è¦‹é€ƒã—ã«ã‚ˆã‚‹è¢«å®³ã®æ‹¡å¤§ãŒç™ºç”Ÿã—ã¾ã™ã€‚

## ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ã‚¹ãƒˆã®å•é¡Œ

ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒ¼ãƒ ãŒä»–ãƒãƒ¼ãƒ ã¨é€£æºã™ã‚‹éš›ã®å¤§ããªèª²é¡Œã¯ã€çŠ¶æ³ã«ã‚ˆã£ã¦ä½¿ã„ãŸã„ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ãŒç•°ãªã‚‹ã“ã¨ã§ã™ã€‚

æ—¥å¸¸çš„ãªç¢ºèªã‚„ç°¡å˜ãªè³ªå•ã§ã‚ã‚Œã°ã€Slackã‚„Teamsãªã©ã®ãƒãƒ£ãƒƒãƒˆãƒ„ãƒ¼ãƒ«ã§ç´ æ—©ãã‚„ã‚Šå–ã‚Šã—ãŸã„ã‚‚ã®ã§ã™ã€‚ã—ã‹ã—ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å°‚ç”¨ãƒ„ãƒ¼ãƒ«ãŒç‹¬ç«‹ã—ã¦ã„ã‚‹ã¨ã€ã‚¢ãƒ©ãƒ¼ãƒˆæƒ…å ±ã‚’å…±æœ‰ã™ã‚‹ã«ã¯æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆã™ã‚‹ãªã©ã—ã¦ã‚·ã‚¹ãƒ†ãƒ ã‚’æ¨ªæ–­ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯åœ°å‘³ã«é¢å€’ãªä½œæ¥­ã§ã€ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¥ã‚‰ã•ãŒç”Ÿã¾ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚

ä¸€æ–¹ã€è©³ç´°ãªèª¿æŸ»ã‚„è¤‡é›‘ãªåˆ†æžãŒå¿…è¦ãªå ´åˆã¯ã€å°‚é–€çš„ãªæ©Ÿèƒ½ã‚’æŒã¤Web UIãŒæ¬ ã‹ã›ã¾ã›ã‚“ã€‚ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€éŽåŽ»ã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã¨ã®æ¯”è¼ƒã€è¦–è¦šçš„ãªæƒ…å ±è¡¨ç¾ãªã©ã€ãƒãƒ£ãƒƒãƒˆãƒ„ãƒ¼ãƒ«ã§ã¯å®Ÿç¾ã§ããªã„æ©Ÿèƒ½ãŒå¿…è¦ã§ã™ã€‚ã¾ãŸã€æ·±å¤œã‚„ä¼‘æ—¥ã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œã§ã¯ã€è‡ªå®…ã‹ã‚‰ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

ç†æƒ³çš„ãªã®ã¯ã€ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ãªã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯Slackã€æœ¬æ ¼çš„ãªåˆ†æžã«ã¯Web UIã¨ã„ã†ä½¿ã„åˆ†ã‘ã‚’ã€ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«å®Ÿç¾ã™ã‚‹ã“ã¨ã§ã™ã€‚ã—ã‹ã—ã€å¾“æ¥ã¯ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚³ã‚¹ãƒˆã®è¦³ç‚¹ã‹ã‚‰äºŒé‡ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æŒã¤ã“ã¨ã¯é¿ã‘ã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚

## ãƒ«ãƒ¼ãƒ«èª¿æ•´ã®é›£ã—ã•

ãƒŽã‚¤ã‚ºã‚’æ¸›ã‚‰ã—ã€é‡è¦ãªã‚¢ãƒ©ãƒ¼ãƒˆã‚’è¦‹é€ƒã•ãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã¯ã€æ¤œçŸ¥ãƒ«ãƒ¼ãƒ«ã®ç¶™ç¶šçš„ãªèª¿æ•´ãŒå¿…è¦ã§ã™ã€‚ã“ã‚Œã¯æ±ºå®šæ€§ã®ã‚ã‚‹ãƒ«ãƒ¼ãƒ«ã§å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€ãƒ«ãƒ¼ãƒ«ã®ä½œæˆã¨èª¿æ•´ã¯æ„å¤–ã¨æ‰‹é–“ãŒã‹ã‹ã‚‹ä½œæ¥­ã§ã™ã€‚

æ¤œçŸ¥ãƒ«ãƒ¼ãƒ«ã®èª¿æ•´ãŒãªãœé›£ã—ã„ã®ã‹ã€å…·ä½“ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ä¾‹ãˆã°ã€ã€ŒçŸ­æ™‚é–“ã§ã®å¤§é‡ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ã€ã‚’æ¤œçŸ¥ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã‚’è€ƒãˆã¾ã™ã€‚æœ€åˆã¯å˜ç´”ã«ã€Œ5åˆ†é–“ã§10å›žä»¥ä¸Šã®ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ã€ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã—ãŸã¨ã—ã¾ã™ã€‚

```
if (login_failure_count > 10 and time_window <= 5_minutes) {
    alert("Possible brute force attack")
}
```

ã—ã‹ã—ã€ã“ã®ãƒ«ãƒ¼ãƒ«ã‚’é‹ç”¨ã—ã¦ã„ãã¨ã€æ§˜ã€…ãªå•é¡ŒãŒç™ºç”Ÿã—ã¾ã™ï¼š

1. **æ­£å½“ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã®èª¤å…¥åŠ›**: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½•åº¦ã‚‚è©¦è¡Œã™ã‚‹
2. **è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã®èª¤å‹•ä½œ**: ç›£è¦–ãƒ„ãƒ¼ãƒ«ã‚„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ„ãƒ¼ãƒ«ãŒé–“é•ã£ãŸèªè¨¼æƒ…å ±ã§æŽ¥ç¶šã‚’è©¦ã¿ã‚‹
3. **ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã®å‹•ä½œ**: é–‹ç™ºè€…ãŒãƒ†ã‚¹ãƒˆç’°å¢ƒã§æ„å›³çš„ã«å¤±æ•—ã•ã›ã‚‹

ã“ã‚Œã‚‰ã®èª¤æ¤œçŸ¥ã‚’æ¸›ã‚‰ã™ãŸã‚ã«ã€é™¤å¤–æ¡ä»¶ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ï¼š

```
if (login_failure_count > 10 && time_window <= 5_minutes) {
    if (source_ip not in internal_network ||
        (source_ip in internal_network && user_department == "IT")) {

        if (username not in service_accounts &&
            !username.matches("test_*")) {

            if (target_system not in test_environments) {
                if (time_of_day not between "02:00" and "05:00" ||
                    (time_of_day between "02:00" and "05:00" &&
                     source_country in ["JP", "US", "GB"])) {

                    if (previous_successful_login_days > 7 ||
                        user_status != "inactive") {

                        alert("Possible brute force attack")
                    }
                }
            } else if (target_system in staging_environments &&
                       failure_pattern != "sequential_passwords") {
                alert("Suspicious activity in staging")
            }
        }
    }
}
```

ã—ã‹ã—ã€é™¤å¤–æ¡ä»¶ã‚’è¿½åŠ ã™ã‚Œã°ã™ã‚‹ã»ã©ã€ãƒ«ãƒ¼ãƒ«ã¯è¤‡é›‘ã«ãªã£ã¦ã„ãã¾ã™ã€‚ãã—ã¦ã€æ–°ãŸãªå•é¡ŒãŒç™ºç”Ÿã—ã¾ã™ï¼š

- **ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®å›°é›£ã•**: ã©ã®æ¡ä»¶ãŒãªãœè¿½åŠ ã•ã‚ŒãŸã®ã‹ã€æ™‚é–“ãŒçµŒã¤ã¨åˆ†ã‹ã‚‰ãªããªã‚‹
- **ç›¸äº’ä½œç”¨ã®è¤‡é›‘ã•**: è¤‡æ•°ã®ãƒ«ãƒ¼ãƒ«ãŒç›¸äº’ã«å½±éŸ¿ã—åˆã„ã€äºˆæœŸã—ãªã„å‹•ä½œã‚’ã™ã‚‹
- **å¤‰æ›´ã®å½±éŸ¿ç¯„å›²**: ä¸€ã¤ã®æ¡ä»¶ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€ä»–ã®æ¤œçŸ¥ã«ã‚‚å½±éŸ¿ãŒå‡ºã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹

å®Ÿéš›ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã§ã¯ã€ã“ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒ«ãŒæ•°åã€æ•°ç™¾ã¨å­˜åœ¨ã—ã¾ã™ã€‚ãã‚Œãžã‚Œã®ãƒ«ãƒ¼ãƒ«ãŒç‹¬è‡ªã®æ¡ä»¶ã¨é™¤å¤–ãƒªã‚¹ãƒˆã‚’æŒã¡ã€ç›¸äº’ã«é–¢é€£ã—åˆã£ã¦ã„ã¾ã™ã€‚æ–°ã—ã„è„…å¨ãŒç™ºè¦‹ã•ã‚ŒãŸã‚Šã€ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆãŒå¤‰æ›´ã•ã‚ŒãŸã‚Šã™ã‚‹ãŸã³ã«ã€ã“ã‚Œã‚‰ã®ãƒ«ãƒ¼ãƒ«ã‚’è¦‹ç›´ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã•ã‚‰ã«ã€ãƒ«ãƒ¼ãƒ«ã®èª¿æ•´ã«ã¯é«˜åº¦ãªå°‚é–€çŸ¥è­˜ãŒå¿…è¦ã§ã™ã€‚ã©ã®ã‚ˆã†ãªæ”»æ’ƒãƒ‘ã‚¿ãƒ¼ãƒ³ãŒå­˜åœ¨ã™ã‚‹ã®ã‹ã€ãã‚Œã‚’ã©ã®ã‚ˆã†ã«æ¤œçŸ¥ã™ã‚‹ã®ã‹ã€èª¤æ¤œçŸ¥ã‚’ã©ã®ã‚ˆã†ã«å›žé¿ã™ã‚‹ã®ã‹ã€ã“ã‚Œã‚‰ã™ã¹ã¦ã‚’ç†è§£ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€çµ„ç¹”å›ºæœ‰ã®ç’°å¢ƒã‚„ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚‚è€ƒæ…®ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚

ãƒ«ãƒ¼ãƒ«ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã“ã¨ã‚‚é‡è¦ã§ã™ãŒã€ã“ã‚Œã‚‚ç°¡å˜ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æœ¬ç•ªç’°å¢ƒã§ãƒ†ã‚¹ãƒˆã™ã‚‹ã“ã¨ã¯ãƒªã‚¹ã‚¯ãŒé«˜ãã€ã‹ã¨ã„ã£ã¦ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã¯æœ¬ç•ªç’°å¢ƒã®è¤‡é›‘ã•ã‚’å®Œå…¨ã«å†ç¾ã™ã‚‹ã“ã¨ã¯å›°é›£ã§ã™ã€‚çµæžœã¨ã—ã¦ã€ãƒ«ãƒ¼ãƒ«ã®å¤‰æ›´ã¯æ…Žé‡ã«è¡Œã‚ã–ã‚‹ã‚’å¾—ãšã€æ”¹å–„ã®ã‚¹ãƒ”ãƒ¼ãƒ‰ãŒé…ããªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

ã“ã®ã‚ˆã†ãªçŠ¶æ³ã§ã¯ã€ãƒ«ãƒ¼ãƒ«ã®èª¿æ•´è‡ªä½“ãŒå¤§ããªè² æ‹…ã¨ãªã‚Šã€çµæžœã¨ã—ã¦ã€Œå‹•ã„ã¦ã„ã‚‹ãƒ«ãƒ¼ãƒ«ã¯è§¦ã‚‰ãªã„ã€ã¨ã„ã†æ¶ˆæ¥µçš„ãªå§¿å‹¢ã«ãªã‚ŠãŒã¡ã§ã™ã€‚ã—ã‹ã—ã€ã“ã‚Œã§ã¯æ–°ã—ã„è„…å¨ã«å¯¾å¿œã§ããšã€ã¾ãŸèª¤æ¤œçŸ¥ã‚‚æ¸›ã‚‰ã™ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚ã“ã®ä½œæ¥­ã‚‚ã€ç”ŸæˆAIã®æ”¯æ´ã‚’å—ã‘ã‚‹ã“ã¨ã§å¤§å¹…ã«åŠ¹çŽ‡åŒ–ã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã¨è€ƒãˆã¾ã—ãŸã€‚

# Warrenã§ã®è§£æ±ºã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

ã“ã‚Œã‚‰ã®èª²é¡Œã«å¯¾ã—ã¦ã€Warrenã§ã¯ç”ŸæˆAIã‚’æ´»ç”¨ã—ãŸæ–°ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æŽ¡ç”¨ã—ã¾ã—ãŸã€‚ç”ŸæˆAIã®ç™»å ´ã«ã‚ˆã‚Šã€ã“ã‚Œã¾ã§ä¸å¯èƒ½ã ã£ãŸæŸ”è»Ÿãªè‡ªå‹•åŒ–ãŒå¯èƒ½ã«ãªã£ã¦ãã¦ã„ã¾ã™ã€‚ç‰¹ã«ã€è‡ªç„¶è¨€èªžå‡¦ç†èƒ½åŠ›ã®å‘ä¸Šã«ã‚ˆã‚Šã€æ›–æ˜§ãªæŒ‡ç¤ºã‹ã‚‰ã§ã‚‚é©åˆ‡ãªå‡¦ç†ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

Warrenã®é–‹ç™ºã«ãŠã„ã¦é‡è¦ã ã£ãŸã®ã¯ã€ç”ŸæˆAIã‚’å˜ãªã‚‹ã€Œãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã€ã¨ã—ã¦ä½¿ã†ã®ã§ã¯ãªãã€å®Ÿéš›ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é‹ç”¨ã«çµ„ã¿è¾¼ã‚ã‚‹å®Ÿç”¨çš„ãªãƒ„ãƒ¼ãƒ«ã¨ã—ã¦è¨­è¨ˆã™ã‚‹ã“ã¨ã§ã—ãŸã€‚ä»¥ä¸‹ã€ä¸»è¦ãªè§£æ±ºç­–ã«ã¤ã„ã¦èª¬æ˜Žã—ã¾ã™ã€‚

## ã‚¢ãƒ©ãƒ¼ãƒˆåˆ†æžã«ãŠã‘ã‚‹LLMã®æ´»ç”¨

Warrenã®æœ€ã‚‚ç‰¹å¾´çš„ãªæ©Ÿèƒ½ã¯ã€LLMï¼ˆLarge Language Modelï¼‰ã‚’æ´»ç”¨ã—ãŸã‚¢ãƒ©ãƒ¼ãƒˆåˆ†æžã§ã™ã€‚å¾“æ¥ã®SOARãƒ„ãƒ¼ãƒ«ã®ã‚ˆã†ãªåŽ³å¯†ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æŽ’é™¤ã—ã€ã‚ˆã‚ŠæŸ”è»Ÿãªåˆ†æžã‚’å¯èƒ½ã«ã—ã¾ã—ãŸã€‚

### åŽ³å¯†ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®æŽ’é™¤

å¾“æ¥ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ™ãƒ¼ã‚¹ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã¯ã€ã‚¢ãƒ©ãƒ¼ãƒˆã‹ã‚‰å¿…è¦ãªæƒ…å ±ï¼ˆIPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ‰ãƒ¡ã‚¤ãƒ³åã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚·ãƒ¥ãªã©ï¼‰ã‚’æŠ½å‡ºã™ã‚‹ãŸã‚ã«ã€ã‚¢ãƒ©ãƒ¼ãƒˆã®ç¨®é¡žã”ã¨ã«ç´°ã‹ããƒžãƒƒãƒ”ãƒ³ã‚°ã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚ã¾ãŸã€å‡¦ç†ã®æµã‚Œã‚‚äº‹å‰ã«å®šç¾©ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚Šã€ã“ã‚ŒãŒãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚³ã‚¹ãƒˆã®å¢—å¤§ã«ã¤ãªãŒã£ã¦ã„ã¾ã—ãŸã€‚

Warrenã§ã¯ã€LLMãŒã‚¢ãƒ©ãƒ¼ãƒˆã®å†…å®¹ã‚’ç†è§£ã—ã€è‡ªå‹•çš„ã«åˆ†æžå¯¾è±¡ã¨ãªã‚‹æŒ‡æ¨™ï¼ˆindicatorï¼‰ã‚’æŠ½å‡ºã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¢ãƒ©ãƒ¼ãƒˆã”ã¨ã«ç´°ã‹ããƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’çµ„ã‚€å¿…è¦ãŒãªããªã‚Šã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚³ã‚¹ãƒˆãŒå¤§å¹…ã«å‰Šæ¸›ã•ã‚Œã¾ã—ãŸã€‚

### AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåŒ–

![](https://storage.googleapis.com/zenn-user-upload/268c68ebfdd3-20250729.png)
_Slackä¸Šã§AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å•ã„åˆã‚ã›å¯èƒ½_

Warrenã®AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç°¡å˜ãªæŒ‡ç¤ºã‹ã‚‰ã€ã©ã®ã‚ˆã†ãªä½œæ¥­ãŒå¿…è¦ã‹ã‚’è‡ªå¾‹çš„ã«åˆ¤æ–­ã—ã¾ã™ã€‚ä¾‹ãˆã°ã€Œã“ã®ãƒã‚±ãƒƒãƒˆã®ã™ã¹ã¦ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’åˆ†æžã—ã¦ã€ã¨ã„ã†æŒ‡ç¤ºã‚’ä¸Žãˆã‚‹ã¨ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ãªä½œæ¥­ã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã—ã¾ã™ï¼š

1. ãƒã‚±ãƒƒãƒˆã«å«ã¾ã‚Œã‚‹ã‚¢ãƒ©ãƒ¼ãƒˆã‹ã‚‰IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŠ½å‡º
2. å„IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾ã—ã¦è„…å¨ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆVirusTotalã€OTXã€AbuseIPDBãªã©ï¼‰ã‚’ãƒã‚§ãƒƒã‚¯
3. çµæžœã‚’ã¾ã¨ã‚ã¦å ±å‘Š

ã•ã‚‰ã«ã€è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã«å¯¾ã—ã¦ã¯ã€ŒPlan & Executionã€ãƒ¢ãƒ¼ãƒ‰ãŒç™ºå‹•ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€Claude Codeãªã©ã®é–‹ç™ºæ”¯æ´AIãƒ„ãƒ¼ãƒ«ã«æ­è¼‰ã•ã‚Œã¦ã„ã‚‹æ©Ÿèƒ½ã¨åŒæ§˜ã®ã‚‚ã®ã§ã€ã‚¿ã‚¹ã‚¯ã‚’è¤‡æ•°ã®ã‚¹ãƒ†ãƒƒãƒ—ã«åˆ†è§£ã—ã€é€²æ—ã‚’è¡¨ç¤ºã—ãªãŒã‚‰å®Ÿè¡Œã—ã¦ã„ãã¾ã™ã€‚

åˆ©ç”¨å¯èƒ½ãªãƒ„ãƒ¼ãƒ«ã«ã¯ã€Warrenå†…éƒ¨ãƒ„ãƒ¼ãƒ«ï¼ˆã‚¢ãƒ©ãƒ¼ãƒˆå–å¾—ã€é¡žä¼¼ãƒã‚±ãƒƒãƒˆæ¤œç´¢ã€èª¿æŸ»çµæžœæ›´æ–°ãªã©ï¼‰ã¨ã€å¤–éƒ¨è„…å¨ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆVirusTotalã€OTXã€AbuseIPDBã€Shodanã€URLScanãªã©ï¼‰ãŒã‚ã‚Šã¾ã™ã€‚

### MCPã«ã‚ˆã‚‹æ‹¡å¼µæ€§

ãƒ„ãƒ¼ãƒ«åˆ©ç”¨ã®æ–‡è„ˆã§ã¯ã€æ‹¡å¼µæ€§ã®è¦³ç‚¹ã‹ã‚‰ MCPï¼ˆModel Context Protocolï¼‰ã¸ã‚‚å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚MCPã¯ã€AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã‚’æŽ¥ç¶šã™ã‚‹ãŸã‚ã®æ¨™æº–åŒ–ã•ã‚ŒãŸãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€çµ„ç¹”å›ºæœ‰ã®ãƒ„ãƒ¼ãƒ«ã‚„ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’Warrenã«çµ±åˆã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

ä¾‹ãˆã°ã€çµ„ç¹”å›ºæœ‰ã®è³‡ç”£ç®¡ç†ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒã‚ã‚‹å ´åˆã€MCPã‚µãƒ¼ãƒãƒ¼ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰ç›´æŽ¥ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã“ã®è¨­å®šã«ã‚ˆã‚Šã€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€Œã“ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ç«¯æœ«ã®æƒ…å ±ã‚’æ•™ãˆã¦ã€ã¨ã„ã£ãŸè‡ªç„¶è¨€èªžã®æŒ‡ç¤ºã«å¯¾ã—ã¦ã€çµ„ç¹”ã®è³‡ç”£ç®¡ç†ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å‚ç…§ã—ã¦å›žç­”ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```yaml
# mcp-config.yaml
servers:
  - name: "asset-db"
    type: "http"
    url: "https://internal-api.example.com/mcp"
    headers:
      Authorization: "Bearer YOUR_API_KEY"
```

MCPã®ç‰¹å¾´ã¯å®Ÿè£…ãŒéžå¸¸ã«å®¹æ˜“ã§ã‚ã‚‹ç‚¹ã§ã™ã€‚ãƒ—ãƒ­ãƒˆã‚³ãƒ«è‡ªä½“ãŒã‚·ãƒ³ãƒ—ãƒ«ãªã®ã¨å„è¨€èªžã«å¯¾ã—ã¦SDKãŒç”¨æ„ã•ã‚Œã¦ãŠã‚Šã€åŸºæœ¬çš„ã«ã¯å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¨˜è¿°ã™ã‚‹ã ã‘ã§MCPã‚µãƒ¼ãƒãƒ¼ã‚’å®Ÿè£…ã§ãã¾ã™ã€‚ã¾ãŸè¿‘å¹´ã®ç”ŸæˆAIé–‹ç™ºã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ´»ç”¨ã‚‚ã€MCPé–‹ç™ºã«å¤§ã„ã«åˆ©ç”¨ã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ç‹¬è‡ªã®æƒ…å ±æºã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½ã¨ãªã‚Šã€ã‚¢ãƒ©ãƒ¼ãƒˆåˆ†æžã®å¹…ã‚’åºƒã’ã‚‰ã‚Œã¾ã™ã€‚

### BigQueryã¨ã®é€£æº

Warrenã¯ã€BigQueryã¨ã®é€£æºã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å¤§è¦æ¨¡ãªãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ã®åˆ†æžãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€è‡ªç„¶è¨€èªžã§ã®è³ªå•ã‚’é©åˆ‡ãªSQLã‚¯ã‚¨ãƒªã«å¤‰æ›ã—ã€çµæžœã‚’åˆ†ã‹ã‚Šã‚„ã™ãæ•´ç†ã—ã¦æç¤ºã—ã¾ã™ã€‚

ä¾‹ãˆã°ã€ã€Œå…ˆé€±ã€ã“ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ãŒã‚ã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’èª¿ã¹ã¦ã€ã¨ã„ã†æŒ‡ç¤ºã«å¯¾ã—ã¦ã€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå‡¦ç†ã‚’è¡Œã„ã¾ã™ï¼š

1. é©åˆ‡ãªBigQueryãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç‰¹å®š
2. SQLã‚¯ã‚¨ãƒªã‚’ç”Ÿæˆã—ã¦å®Ÿè¡Œ
3. çµæžœã‚’æ•´ç†ã—ã¦ã€é‡è¦ãªæƒ…å ±ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
4. å¿…è¦ã«å¿œã˜ã¦è¿½åŠ ã®åˆ†æžã‚’ææ¡ˆ

ã—ã‹ã—ã€å˜ç´”ã«BigQueryã®ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±ã‚’æ¸¡ã™ã ã‘ã§ã¯ã€ç”ŸæˆAIã¯ä½•ã‚’ã™ã¹ãã‹åˆ¤æ–­ã§ããªã„ã¨ã„ã†ã®ãŒç¾å®Ÿã§ã™ã€‚ç‰¹ã«ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç³»ã§åˆ©ç”¨ã™ã‚‹ç›£æŸ»ãƒ­ã‚°ãªã©ã¯ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ•°ãŒè†¨å¤§ã§ã€ãã‚Œãžã‚Œã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æ„å‘³ã‚„é–¢é€£æ€§ã‚’ç†è§£ã™ã‚‹ã®ã¯å›°é›£ã§ã™ã€‚

ãã“ã§Warrenã¯ã€BigQueryãƒ†ãƒ¼ãƒ–ãƒ«ã®äº‹å‰åˆ†æžæ©Ÿèƒ½ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ã“ã®æ©Ÿèƒ½ã¯ã€ã‚¹ã‚­ãƒ¼ãƒžæƒ…å ±ã ã‘ã§ãªãã€å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã‚‚åˆ†æžã—ã€å„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã®ä¾‹ã‚„èª¬æ˜Žã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚ä¾‹ãˆã°ã€Google Cloudã®ç›£æŸ»ãƒ­ã‚°ã«å¯¾ã—ã¦ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæƒ…å ±ãŒç”Ÿæˆã•ã‚Œã¾ã™ï¼š

```yml
dataset_id: google_cloud_audit
table_id: cloudaudit_googleapis_com_system_event
description: Google Cloudã®system event audit log
columns:
    - name: logName
      description: The name of the log.
      value_example: projects/gcp-project-id/logs/cloudaudit.googleapis.com%2Fsystem_event
      type: STRING
      fields: []
    - name: operation
      description: The operation associated with the log entry.
      value_example: ""
      type: RECORD
      fields:
        - name: producer
          description: The producer of the operation.
          value_example: google.cloud.example.ExampleService
          type: STRING
          fields: []
        - name: first
          description: Indicates if this is the first log entry for the operation.
          value_example: "true"
          type: BOOLEAN
          fields: []
        - name: last
          description: Indicates if this is the last log entry for the operation.
          value_example: "false"
          type: BOOLEAN
          fields: []
    - name: timestamp
      description: The time the event occurred.
      value_example: "2023-10-27T10:00:00Z"
      type: TIMESTAMP
      fields: []
```

ã•ã‚‰ã«ã€äº‹å‰ã«å‚è€ƒã¨ãªã‚‹ã‚¯ã‚¨ãƒªã‚’Runbookã¨ã—ã¦ç™»éŒ²ã—ã¦ãŠãã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ã€Œä¸å¯©ãªãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œã‚’æ¤œå‡ºã™ã‚‹ã€ã€Œç‰¹å®šã®ãƒªã‚½ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹å±¥æ­´ã‚’èª¿æŸ»ã™ã‚‹ã€ã¨ã„ã£ãŸç”¨é€”ã®èª¬æ˜Žã‚’ä»˜åŠ ã—ã¦ãŠãã“ã¨ã§ã€Warrenã¯ã“ã‚Œã‚‰ã®ã‚¯ã‚¨ãƒªã‚’å‚è€ƒã«ã—ã¦ã€ã‚ˆã‚Šé©åˆ‡ãªSQLã‚’çµ„ã¿ç«‹ã¦ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®ã‚ˆã†ãªæº–å‚™ã‚’è¡Œã†ã“ã¨ã§ã€BigQueryã®è†¨å¤§ãªãƒ‡ãƒ¼ã‚¿ã‚‚ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æžã®æ–‡è„ˆã§åŠ¹æžœçš„ã«æ´»ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã¨ã„ã†ã®ãŒã€Warrenã®ç‰¹å¾´ã§ã™ã€‚


## ã‚·ã‚°ãƒŠãƒ«ã¨ã—ã¦ã®ã‚¢ãƒ©ãƒ¼ãƒˆã¨å¯¾å¿œãƒã‚±ãƒƒãƒˆã®åˆ†é›¢

Warrenã§ã¯ã€ã€Œã‚¢ãƒ©ãƒ¼ãƒˆã€ã¨ã€Œãƒã‚±ãƒƒãƒˆã€ã¨ã„ã†2ã¤ã®æ¦‚å¿µã‚’æ˜Žç¢ºã«åˆ†é›¢ã—ã¦ã„ã¾ã™ã€‚

- **ã‚¢ãƒ©ãƒ¼ãƒˆ**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‡ãƒã‚¤ã‚¹ã‚„ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰é€ã‚‰ã‚Œã¦ãã‚‹å€‹ã€…ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆ
- **ãƒã‚±ãƒƒãƒˆ**: 1ã¤ä»¥ä¸Šã®é–¢é€£ã™ã‚‹ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ã¾ã¨ã‚ãŸã€èª¿æŸ»ã¨å¯¾å¿œã®å˜ä½

è¤‡æ•°ã®ã‚¢ãƒ©ãƒ¼ãƒˆãŒåŒã˜äº‹è±¡ã‚’æŒ‡ã—ç¤ºã—ã¦ã„ãŸã‚Šã€åŒã˜èª¤æ¤œçŸ¥ã®å•é¡Œã«ã‚ˆã‚‹ã‚‚ã®ã ã£ãŸå ´åˆã€ãã‚Œã‚‰ã‚’ã¾ã¨ã‚ã¦1ã¤ã®ãƒã‚±ãƒƒãƒˆã¨ã—ã¦æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¢ãƒŠãƒªã‚¹ãƒˆã¯å€‹ã€…ã®ã‚¢ãƒ©ãƒ¼ãƒˆã§ã¯ãªãã€æ„å‘³ã®ã‚ã‚‹å˜ä½ã§å¯¾å¿œã‚’é€²ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### Embeddingã«ã‚ˆã‚‹ã‚¢ãƒ©ãƒ¼ãƒˆã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°

ã‚¢ãƒ©ãƒ¼ãƒˆã®é–¢é€£æ€§ã‚’åˆ¤æ–­ã™ã‚‹ãŸã‚ã«ã€Warrenã¯EmbeddingæŠ€è¡“ã‚’æ´»ç”¨ã—ã¦ã„ã¾ã™ã€‚Embeddingã¨ã¯ã€ãƒ‡ãƒ¼ã‚¿ã®æ„å‘³çš„ç‰¹å¾´ã‚’é«˜æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ç©ºé–“ã«ãƒžãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚

å„ã‚¢ãƒ©ãƒ¼ãƒˆã¯256æ¬¡å…ƒã®ãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›ã•ã‚Œã€ã‚³ã‚µã‚¤ãƒ³è·é›¢ã‚’ä½¿ã£ã¦é¡žä¼¼åº¦ã‚’è¨ˆç®—ã—ã€å¸Œæœ›ã®ã‚¢ãƒ©ãƒ¼ãƒˆã®ç™ºè¦‹ã«åˆ©ç”¨ã•ã‚Œã¾ã™ã€‚ã¾ãŸã€DBSCANï¼ˆDensity-Based Spatial Clustering of Applications with Noiseï¼‰ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ã¦ã€é¡žä¼¼ã—ãŸã‚¢ãƒ©ãƒ¼ãƒˆã‚’è‡ªå‹•çš„ã«ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ©Ÿèƒ½ãŒå®Ÿç¾ã§ãã¾ã—ãŸï¼š

- é¡žä¼¼ã™ã‚‹ã‚¢ãƒ©ãƒ¼ãƒˆã‚’è‡ªå‹•çš„ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
- ã‚¯ãƒ©ã‚¹ã‚¿ã‹ã‚‰ãƒã‚±ãƒƒãƒˆã‚’ä¸€æ‹¬ä½œæˆ
- æ—¢å­˜ã®ãƒã‚±ãƒƒãƒˆã«é¡žä¼¼ã—ãŸã‚¢ãƒ©ãƒ¼ãƒˆã‚’è‡ªå‹•çš„ã«é–¢é€£ä»˜ã‘

ä¾‹ãˆã°ã€åŒã˜æ”»æ’ƒã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã«ã‚ˆã‚‹è¤‡æ•°ã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚„ã€åŒã˜èª¤æ¤œçŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹å¤§é‡ã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ã€ç°¡å˜ã«ã¾ã¨ã‚ã¦å‡¦ç†ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ã¾ãŸã€å˜ç´”ã«è¿‘å‚ã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ã¾ã¨ã‚ã‚‹ã ã‘ã ã¨æ„å›³ã—ãªã„æƒ…å ±ãŒç´›ã‚Œè¾¼ã‚€å ´åˆãŒã‚ã‚‹ã®ã§ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§ã®çµžã‚Šè¾¼ã¿ã‚‚ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/03d6dcd09b72-20250729.png)

## Slackã¨Web UIã®é€£æº

å¾“æ¥ã®åŽŸå‰‡ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’äºŒé‡ã«æŒã¤ã“ã¨ã¯ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚³ã‚¹ãƒˆã®è¦³ç‚¹ã‹ã‚‰ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚ã—ã‹ã—ã€ç”ŸæˆAIã«ã‚ˆã‚‹é–‹ç™ºç”Ÿç”£æ€§ã®å‘ä¸Šã«ã‚ˆã‚Šã€ã“ã®åˆ¶ç´„ã‚’å…‹æœã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

### Slackã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

å…ˆç¨‹ã‚‚å°‘ã—ãŠè¦‹ã›ã—ã¾ã—ãŸãŒã€æ—¥å¸¸çš„ãªã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹Slackã‚’ã€ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥ã¨ç°¡å˜ãªæ“ä½œã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ã—ã¦æ´»ç”¨ã—ã¦ã„ã¾ã™ã€‚

ã‚¢ãƒ©ãƒ¼ãƒˆãŒç™ºç”Ÿã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå½¢å¼ã§Slackã«é€šçŸ¥ã•ã‚Œã¾ã™ï¼š

![](https://storage.googleapis.com/zenn-user-upload/c287a232c040-20250729.png)

Slackã‹ã‚‰ç›´æŽ¥ã€ä»¥ä¸‹ã®æ“ä½œãŒå¯èƒ½ã§ã™ï¼š
- ã‚¢ãƒ©ãƒ¼ãƒˆã®ç¢ºèªï¼ˆAcknowledgeï¼‰ã«ã‚ˆã‚‹ãƒã‚±ãƒƒãƒˆä½œæˆ
- æ—¢å­˜ãƒã‚±ãƒƒãƒˆã¸ã®ã‚¢ãƒ©ãƒ¼ãƒˆã®ç´ä»˜ã‘
- ãƒã‚±ãƒƒãƒˆã®è§£æ±ºï¼ˆResolveï¼‰
- é¡žä¼¼ã‚¢ãƒ©ãƒ¼ãƒˆã®æ¤œç´¢ï¼ˆSalvageï¼‰

ã“ã®ã‚¹ãƒ¬ãƒƒãƒ‰ä¸Šã§ãƒãƒ¼ãƒ å†…å¤–ã®ãƒ¡ãƒ³ãƒãƒ¼ã¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã™ã‚‹ã“ã¨ã§ã€ã‚¢ãƒ©ãƒ¼ãƒˆã®æƒ…å ±ã‚’ã‚¹ãƒ ãƒ¼ã‚ºã«ä¼ãˆã¤ã¤è­°è«–ã‚’ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒãƒ¼ãƒ å¤–ã®ãƒ¡ãƒ³ãƒãƒ¼ã«ã¯å¿…è¦ä»¥ä¸Šã®æƒ…å ±ã‚’è¦‹ã›ã‚‹ã“ã¨ãªãã€å°‚ç”¨ã‚·ã‚¹ãƒ†ãƒ ã«ãƒ­ã‚°ã‚¤ãƒ³ã›ãšã«åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### Web UI

ã‚ˆã‚Šè©³ç´°ãªåˆ†æžã‚„ç®¡ç†ä½œæ¥­ã®ãŸã‚ã«ã€ãƒ•ãƒ«æ©Ÿèƒ½ã®Web UIã‚‚æä¾›ã—ã¦ã„ã¾ã™ã€‚Web UIã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ©Ÿèƒ½ãŒåˆ©ç”¨ã§ãã¾ã™ï¼š

![](https://storage.googleapis.com/zenn-user-upload/4e210c8c0581-20250729.png)
- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®å…¨ä½“çŠ¶æ³ã®æŠŠæ¡
- è©³ç´°ãªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã¨ã‚½ãƒ¼ãƒˆ
- è¤‡æ•°ã‚¢ãƒ©ãƒ¼ãƒˆã®ä¸€æ‹¬æ“ä½œ
- AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ã®ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½
- èª¿æŸ»çµæžœã®è¨˜éŒ²ã¨å…±æœ‰

Slackã¨Web UIã¯å®Œå…¨ã«åŒæœŸã—ã¦ãŠã‚Šã€ã©ã¡ã‚‰ã§è¡Œã£ãŸæ“ä½œã‚‚å³åº§ã«åæ˜ ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒãƒ¼ãƒ å¤–ã®ãƒ¡ãƒ³ãƒãƒ¼ã¨ã¯Slackã§ç°¡å˜ã«ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–ã‚ŠãªãŒã‚‰ã€è©³ç´°ãªåˆ†æžä½œæ¥­ã¯Web UIã§è¡Œã†ã¨ã„ã†ã€ãã‚Œãžã‚Œã®å¼·ã¿ã‚’æ´»ã‹ã—ãŸé‹ç”¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚

## ãƒ†ã‚­ã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ã§ã®ãƒ«ãƒ¼ãƒ«ã¨ãƒ†ã‚¹ãƒˆã®å®Ÿè£…

æ¤œçŸ¥ãƒ«ãƒ¼ãƒ«ã®ä½œæˆã¨èª¿æ•´ã«ãŠã„ã¦ã‚‚ã€ç”ŸæˆAIã®æ©æµã‚’å—ã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚ã‚‚ã¨ã‚‚ã¨ãƒ†ã‚­ã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ã®ãƒ«ãƒ¼ãƒ«ã‚’åˆ©æ´»ç”¨ã™ã‚‹ã®ã¯Detection Engineering, Detection as Code, Autonomic Security Operationsãªã©ã®ç€æƒ³ã«ã‚ˆã‚‹ã‚‚ã®ã§ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã«æŒã¡è¾¼ã‚€[^secmoneng]ã“ã¨ã«ã‚ˆã‚‹åŠ¹çŽ‡åŒ–ã®ä¸€ç’°ã¨ãªã‚Šã¾ã™ã€‚

### Regoã«ã‚ˆã‚‹ãƒãƒªã‚·ãƒ¼è¨˜è¿°

Warrenã¯OPAï¼ˆOpen Policy Agentï¼‰ã®ãƒãƒªã‚·ãƒ¼è¨€èªžã§ã‚ã‚‹Regoã‚’ä½¿ç”¨ã—ã¦ãƒ«ãƒ¼ãƒ«ã‚’è¨˜è¿°ã—ã¾ã™ã€‚ãƒ†ã‚­ã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ã®ãƒ«ãƒ¼ãƒ«ã§ã‚ã‚‹ãŸã‚ã€Claude Codeã®ã‚ˆã†ãªé–‹ç™ºç”¨AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ„ãƒ¼ãƒ«ã‚’ãã®ã¾ã¾æ´»ç”¨ã§ãã¾ã™ã€‚

ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªRegoãƒãƒªã‚·ãƒ¼ã§ã€ç‰¹å®šã®æ¡ä»¶ã«åŸºã¥ã„ã¦ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ç”Ÿæˆã§ãã¾ã™ï¼š

```rego
package warren.alert

# åŸºæœ¬çš„ãªãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—æ¤œçŸ¥ãƒ«ãƒ¼ãƒ«
alert contains res if {
    input.event_type == "login_failure"
    input.failure_count > 10
    input.time_window_minutes <= 5
    
    # é™¤å¤–æ¡ä»¶ã®ãƒã‚§ãƒƒã‚¯
    not ignore
    
    res := {
        "title": sprintf("Multiple login failures from %s", [input.source_ip]),
        "description": sprintf("%d failed login attempts in %d minutes", 
            [input.failure_count, input.time_window_minutes]),
        "severity": "high",
        "attributes": [
            {"key": "source_ip", "value": input.source_ip},
            {"key": "failure_count", "value": sprintf("%d", [input.failure_count])},
        ]
    }
}

# å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯é™¤å¤–
ignore if {
    input.source_ip in internal_network
    input.username in service_accounts
}

# ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã®å‹•ä½œã¯é™¤å¤–
ignore if {
    input.target_system in test_environments
    regex.match("test_.*", input.username)
}

# æ·±å¤œã®å®šæœŸãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¸ãƒ§ãƒ–ã¯é™¤å¤–ï¼ˆãŸã ã—æµ·å¤–IPã¯é™¤ãï¼‰
ignore if {
    input.time_of_day >= "02:00"
    input.time_of_day <= "05:00"
    input.source_country in ["JP", "US", "GB"]
    input.username in ["backup_user", "batch_processor"]
}

# ãƒ˜ãƒ«ãƒ‘ãƒ¼å®šç¾©
internal_network := ["10.0.0.0/8", "172.16.0.0/12", "192.168.0.0/16"]
service_accounts := ["monitoring_service", "backup_service", "health_check"]
test_environments := ["test-env", "staging-env", "dev-env"]
```

### AIã‚’æ´»ç”¨ã—ãŸãƒ«ãƒ¼ãƒ«èª¿æ•´

CLAUDE.mdã®ã‚ˆã†ãªäº‹å‰æŒ‡ç¤ºã®ãƒ†ã‚­ã‚¹ãƒˆã«çµ„ç¹”ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚„ãƒ«ãƒ¼ãƒ«ã®æ§‹æˆã‚’è¨˜è¿°ã—ã¦ãŠãã“ã¨ã§ã€AIãŒæ„å›³ã‚’æ±²ã¿å–ã£ã¦ãƒ«ãƒ¼ãƒ«ã‚’ææ¡ˆã—ã¦ãã‚Œã¾ã™ã€‚

ä¾‹ãˆã°ã€èª¤æ¤œçŸ¥ã—ãŸã‚¢ãƒ©ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’ç‰¹å®šã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã—ã€ã€Œã“ã‚Œã‚’ç„¡è¦–ã™ã‚‹ã‚ˆã†ã«ãƒ«ãƒ¼ãƒ«ã‚’èª¿æ•´ã—ã¦ã€ã¨ã„ã†æŒ‡ç¤ºã‚’å‡ºã™ã¨ã€AIã¯æ—¢å­˜ãƒ«ãƒ¼ãƒ«ã¨ã®æ•´åˆæ€§ã‚’è€ƒæ…®ã—ãŸä¸Šã§æœ€é©ãªãƒ«ãƒ¼ãƒ«ã‚’ææ¡ˆã—ã¦ãã‚Œã¾ã™ã€‚ã“ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒ«èª¿æ•´ã¯ã€æ—¢å­˜ãƒ«ãƒ¼ãƒ«ã®æŠŠæ¡ã‚„ã©ã†æ§‹é€ åŒ–ã™ã‚‹ã‹ãªã©è€ƒãˆã‚‹ã“ã¨ãŒå¤šãã€åœ°å‘³ã«è² æ‹…ãŒå¤§ãã„ä½œæ¥­ã§ã—ãŸãŒã€AIã®æ”¯æ´ã«ã‚ˆã‚Šå¤§å¹…ã«åŠ¹çŽ‡åŒ–ã•ã‚Œã¾ã—ãŸã€‚

### ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã®å®Ÿè£…

ã•ã‚‰ã«é‡è¦ãªã®ãŒã€ãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ã®å®Ÿè£…ã§ã™ã€‚ãƒ«ãƒ¼ãƒ«ã‚’å¤‰æ›´ã—ãŸéš›ã«ã€æ¤œçŸ¥ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ãŒé©åˆ‡ã«æ¤œçŸ¥ã•ã‚Œã€ç„¡è¦–ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ãŒé©åˆ‡ã«ç„¡è¦–ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ã€éƒ½åº¦ãƒã‚§ãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

```bash
# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ãƒãƒªã‚·ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆ
warren policy test --policy-dir ./policies --test-dir ./test-data
```

ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ«ãƒ¼ãƒ«å¤‰æ›´ã«ã‚ˆã‚‹å½±éŸ¿ã‚’äº‹å‰ã«ç¢ºèªã§ãã€ã‚ˆã‚Šå®‰å¿ƒã—ã¦ãƒ«ãƒ¼ãƒ«ã®èª¿æ•´ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚


# ã¾ã¨ã‚

Warrenã¯ã€å°è¦æ¨¡ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒ¼ãƒ ãŒç›´é¢ã™ã‚‹èª²é¡Œã‚’ã€ç”ŸæˆAIã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§è§£æ±ºã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ãŸãƒ„ãƒ¼ãƒ«ã§ã™ã€‚å¾“æ¥ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã¯å®Ÿç¾ãŒå›°é›£ã ã£ãŸæŸ”è»Ÿãªè‡ªå‹•åŒ–ã¨ã€ä½¿ã„ã‚„ã™ã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ä¸¡ç«‹ã‚’å®Ÿç¾ã§ããŸã®ã§ã¯ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚

ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã¯ã€è¦æ¨¡ã«é–¢ã‚ã‚‰ãšã™ã¹ã¦ã®çµ„ç¹”ã«ã¨ã£ã¦é‡è¦ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®ä¸€ã¤ã§ã™ã€‚ã—ã‹ã—ã€ãã®é‡è¦æ€§ã«è¦‹åˆã£ãŸãƒªã‚½ãƒ¼ã‚¹ã‚’æŠ•å…¥ã§ãã‚‹çµ„ç¹”ã¯é™ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ç‰¹ã«è£½å“ã‚„ã‚¤ãƒ³ãƒ•ãƒ©ã«ã‹ã‹ã‚‹ã‚³ã‚¹ãƒˆãŒå•é¡Œã¨ã—ã¦æŒ™ãŒã‚Šã‚„ã™ã„ã§ã™ãŒã€å®Ÿéš›ã«ã¯é©åˆ‡ã«é‹ç”¨ã—ã¦ã„ãç¶™ç¶šçš„ãªå¯¾å¿œãŒé›£ã—ã„ã¨è€ƒãˆã¦ã„ã¾ã—ãŸã€‚WarrenãŒã€ãƒªã‚½ãƒ¼ã‚¹ã®åˆ¶ç´„ãŒã‚ã‚‹ä¸­ã§ã‚‚åŠ¹æžœçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã‚’å®Ÿç¾ã™ã‚‹ä¸€ã¤ã®å‚è€ƒã¨ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

[^soar-is-dead]: https://gorkasadowski.medium.com/soar-is-dead-long-live-the-soar-3af6efed730b
[^secmoneng]: https://zenn.dev/mizutani/articles/secmon-24-secmon-engineering
